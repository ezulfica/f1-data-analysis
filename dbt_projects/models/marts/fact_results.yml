
version: 2

models:
  - name: fact_results
    type: analysis
    description: "F1 Race and Sprint Results with Pit Stop Strategies"

    depends_on:
      - ref('int_results')
      - ref('int_sprint_results')
      - ref('int_pitstops_strategy')
    
    maturity: high
    columns:
      - name: schedule_id
        description: "A unique identifier for each race event, generated by concatenating season, round, and circuit ID."
      - name: season
        tests: 
          - not_null
        description: "The racing season (year) in which the race takes place."
      - name: round
        tests: 
          - not_null
        description: "The round number within the season, indicating the order of the race."
      - name: driver_id
        tests: 
          - not_null
        description: "Unique identifier for each F1 driver."
      - name: constructor_id
        description: "Unique identifier for each F1 constructor."
        tests: 
          - not_null
      - name: sprint_status
        description: "The final status of the driver in the sprint race (e.g., Finished, DNF, DNS)."
      - name: sprint_final_position
        description: "Final position of the driver in the sprint race."
      - name: sprint_points
        description: "Points earned by the driver in the sprint race."
      - name: race_grid_position
        description: "The position at which the driver started the race."
      - name: race_status
        description: "The final status of the driver in the race (e.g., Finished, Retired, DNF)."
      - name: race_final_position
        description: "The final finishing position of the driver in the race."
      - name: race_points
        description: "The number of points earned by the driver based on their race result."

    config:
      materialized: table
      unique_key: ["season", "round" ,"driver_id", "constructor_id"]
      
      partition_by:
        field: "season"
        data_type : "int64"
        range : 
          start: 1950
          end: 2050
          interval: 1
        
      cluster_by: ["round"]

